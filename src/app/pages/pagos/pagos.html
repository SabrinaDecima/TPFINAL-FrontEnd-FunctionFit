<div class="max-w-4xl mx-auto py-12 space-y-8">

  <div *ngIf="loading()" class="text-center text-slate-400">
    Cargando pagos...
  </div>

  <div *ngIf="checkingPayment()" class="text-center text-slate-500">
    Verificando estado de pago con MercadoPago... â³
  </div>

  <div
    *ngIf="!loading() && currentPayment()"
    class="rounded-2xl p-6 shadow-lg"
    [ngClass]="
      currentPayment()?.Pagado
        ? 'bg-green-500 text-white'
        : 'bg-yellow-400 text-slate-900'
    "
  >
    <h2 class="text-xl font-semibold mb-2">Estado de tu membresÃ­a</h2>

    <p class="text-lg">
      {{ formatDate(currentPayment()?.Fecha) }} Â·
      <span class="font-bold">
        {{ currentPayment()?.Pagado ? 'Pagado' : 'Pendiente' }}
      </span>
    </p>

    <button
      *ngIf="!currentPayment()?.Pagado"
      (click)="pay()"
      class="mt-4 bg-slate-900 text-yellow-400 px-6 py-2 rounded-xl font-semibold hover:bg-slate-800 transition mr-2"
    >
      Pagar ahora
    </button>

    <button
      *ngIf="!currentPayment()?.Pagado"
      (click)="verifyLastPayment()"
      class="mt-4 bg-white/20 text-slate-900 px-6 py-2 rounded-xl font-semibold hover:bg-white/30 transition border border-slate-900/10"
    >
      Ya paguÃ© (Verificar)
    </button>

    <p *ngIf="currentPayment()?.Pagado" class="mt-2">
      Â¡MembresÃ­a activa! ğŸ’ª
    </p>
  </div>

  <div *ngIf="!loading() && !currentPayment()" class="text-center text-slate-600">
    Â¡No hay pagos pendientes!
  </div>

  <div *ngIf="!loading() && paymentHistory().length">
    <h3 class="text-lg font-semibold mb-4">Historial de pagos</h3>

    <div class="grid sm:grid-cols-2 gap-4">
      <div
        *ngFor="let pago of paymentHistory()"
        class="rounded-2xl p-4 border shadow-md"
      >
        <p><b>Fecha:</b> {{ formatDate(pago.Fecha) }}</p>
        <p><b>Monto:</b> ${{ pago.Monto }}</p>
        <p>
          <b>Estado:</b>
          <span [class.text-green-500]="pago.Pagado"
                [class.text-red-500]="!pago.Pagado">
            {{ pago.Pagado ? 'Pagado' : 'Pendiente' }}
          </span>
        </p>
      </div>
    </div>
  </div>
</div>
